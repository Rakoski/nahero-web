<div class="container mx-auto px-4 py-8">
  <div class="mb-8">
    <h1 class="text-3xl font-bold mb-4">Simulados</h1>

    <div class="flex flex-col md:flex-row md:items-end gap-4 mb-4">
      <div class="flex-1">
        <input
          ubInput
          type="text"
          placeholder="Buscar Simulados..."
          [(ngModel)]="searchQuery"
          (keyup.enter)="onSearch()"
          class="w-full"
        />
      </div>

      <button
        ubButton
        class="bg-primary text-primary-foreground px-4 py-2 rounded-lg hover:bg-primary/90"
        (click)="onSearch()"
      >
        Search
      </button>
    </div>
  </div>

  <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
    @for (practiceExam of practiceExams; track practiceExam.id) {
    <div ubCard class="overflow-hidden">
      <div ubCardHeader>
        <div class="flex justify-between items-start mb-2">
          <div>
            <h3 ubCardTitle>{{ practiceExam.title }}</h3>
            <p ubCardDescription>{{ practiceExam.exam.title }}</p>
          </div>
          <div class="px-2 py-1 bg-primary text-primary-foreground rounded text-sm">
            {{ getDifficultyLabel(practiceExam.difficultyLevel ?? 0) }}
          </div>
        </div>
      </div>
      <div ubCardContent>
        <p class="mb-4">{{ practiceExam.description }}</p>
        <div class="space-y-2 text-sm text-muted-foreground">
          <div class="flex items-center justify-between">
            <span>Time Limit:</span>
            <span>{{ formatTimeLimit(practiceExam.timeLimit) }}</span>
          </div>
          <div class="flex items-center justify-between">
            <span>Passing Score:</span>
            <span>{{ practiceExam.passingScore }}%</span>
          </div>
          <div class="flex items-center justify-between">
            <span>Created by:</span>
            <span>{{ practiceExam.teacher.name }}</span>
          </div>
        </div>
      </div>
      <div ubCardFooter class="justify-end space-x-2">
        <button
          class="bg-primary text-primary-foreground px-4 py-2 rounded-lg hover:bg-primary/90"
          (click)="router.navigate(['/practice-exam', practiceExam.id])"
        >
          Start Practice
        </button>
      </div>
    </div>
    }
  </div>

  @if (practiceExams.length === 0) {
  <div class="text-center py-12 text-muted-foreground">
    No practice exams found matching your search criteria
  </div>
  } @if (totalPages > 1) {
  <div class="flex justify-center mt-8 gap-2">
    <button
      ubButton
      [disabled]="pageOptions.page === 0"
      (click)="prevPage()"
      class="px-4 py-2 rounded-lg bg-secondary text-secondary-foreground hover:bg-secondary/80 disabled:opacity-50"
    >
      Previous
    </button>

    @for (page of [].constructor(totalPages > 5 ? 5 : totalPages); track $index) { @if (totalPages
    <= 5 || (pageOptions.page - 2 + $index >= 0 && pageOptions.page - 2 + $index < totalPages)) {
    <button
      ubButton
      [class.bg-primary]="
        pageOptions.page === (totalPages <= 5 ? $index : pageOptions.page - 2 + $index)
      "
      [class.text-primary-foreground]="
        pageOptions.page === (totalPages <= 5 ? $index : pageOptions.page - 2 + $index)
      "
      [class.bg-secondary]="
        pageOptions.page !== (totalPages <= 5 ? $index : pageOptions.page - 2 + $index)
      "
      [class.text-secondary-foreground]="
        pageOptions.page !== (totalPages <= 5 ? $index : pageOptions.page - 2 + $index)
      "
      (click)="changePage(totalPages <= 5 ? $index : pageOptions.page - 2 + $index)"
      class="px-4 py-2 rounded-lg hover:bg-secondary/80"
    >
      {{ (totalPages <= 5 ? $index : pageOptions.page - 2 + $index) + 1 }}
    </button>
    } }

    <button
      ubButton
      [disabled]="pageOptions.page === totalPages - 1"
      (click)="nextPage()"
      class="px-4 py-2 rounded-lg bg-secondary text-secondary-foreground hover:bg-secondary/80 disabled:opacity-50"
    >
      Next
    </button>
  </div>
  }
</div>
